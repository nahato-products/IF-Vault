下記は、対象のスプレッドシートのシート（タブ）ごとに
**"シート名"列行：=元々書かれてた関数**
の組み合わせを列挙している。
これをGASに置き換えたい。

```


"0A_フィルター"A2：
=LET( format, HSTACK( Anthem_GAS!A:A, Anthem_GAS!B:B, Anthem_GAS!C:C, Anthem_GAS!D:D, Anthem_GAS!E:E, Anthem_GAS!F:F, Anthem_GAS!G:G ), excludePattern, TEXTJOIN("|", TRUE, FILTER('IF卸・トータルマーケ'!A:A, 'IF卸・トータルマーケ'!A:A<>"")), FILTER( format, ( NOT( REGEXMATCH( INDEX(format,,3), excludePattern ) ) ) * ( NOT( ISNUMBER( SEARCH("ハウス/", INDEX(format,,5) ) ) ) ) * ( INDEX(format,,7) <> "否認" ) * ( INDEX(format,,3) <> "" ) ) ) 

"0B_IF卸"A2：
=LET(
  format, HSTACK(
    Anthem_GAS!A:A,
    Anthem_GAS!B:B,
    Anthem_GAS!C:C,
    Anthem_GAS!D:D,
    Anthem_GAS!E:E,
    Anthem_GAS!F:F,
    Anthem_GAS!G:G
  ),
  excludePattern, TEXTJOIN("|", TRUE, FILTER('IF卸・トータルマーケ'!A:A, 'IF卸・トータルマーケ'!A:A<>"", 'IF卸・トータルマーケ'!B:B="IF卸")),
  FILTER(
    format,
    ( REGEXMATCH(INDEX(format,,3), excludePattern) ) *
    ( NOT( ISNUMBER(SEARCH("テスト", INDEX(format,,3))) ) ) *
    ( NOT( ISNUMBER(SEARCH("（松下）アイコ", INDEX(format,,3))) ) ) *
    ( INDEX(format,,7) <> "否認" ) *
    ( INDEX(format,,3) <> "" )
  )
)

"0B_IF卸"H2：
=ArrayFormula(
iferror(
let(
パートナーサイト,C2:C,
卸先,
 if(regexmatch(パートナーサイト,":"),
 mid( パートナーサイト,find( ":",パートナーサイト) +2, 300),
 パートナーサイト),

if(regexmatch(卸先,"_"),
left( 卸先,find( "_",卸先) -1),
if( regexmatch(卸先,"【")*regexmatch(卸先,"（"),
left( 卸先,find( "（",卸先) -1),
if(regexmatch(卸先,"【"),
left( 卸先,find( "【",卸先) -1),
if(regexmatch(卸先,"（"),
left( 卸先,find( "（",卸先) -1),
卸先)))))))

"0B_IF卸"I2：
=ArrayFormula(
iferror(
let(広告主,D2:D,

if(isblank(広告主),,
mid(広告主, find(":",広告主)+2,300)))))

"0B_IF卸"J2：=ArrayFormula(
  iferror(
    if(E2:E="261IN_ピットソール", "ピットソール",
      let(
        広告, E2:E,
        カッコ抜く, mid(広告, find("】", 広告) + 1, 300),

        ハウス,
        if(regexmatch(カッコ抜く, "【"),
          left(カッコ抜く, find("【", カッコ抜く) - 1),
          カッコ抜く),

        if(ハウス="",
          mid(広告, find("_", 広告) + 1, find("【", 広告) - find("_", 広告) - 1),
          ハウス)
      )
    )
  )
)

"0C_マーケ"A2：
=LET(
  format, HSTACK(
    Anthem_GAS!A:A,
    Anthem_GAS!B:B,
    Anthem_GAS!C:C,
    Anthem_GAS!D:D,
    Anthem_GAS!E:E,
    Anthem_GAS!F:F,
    Anthem_GAS!G:G
  ),
  excludePattern, TEXTJOIN("|", TRUE, FILTER('IF卸・トータルマーケ'!A:A, 'IF卸・トータルマーケ'!A:A<>"", 'IF卸・トータルマーケ'!B:B="トータルマーケ")),
  FILTER(
    format,
    ( REGEXMATCH(INDEX(format,,3), excludePattern) ) *
    ( NOT( ISNUMBER(SEARCH("テスト", INDEX(format,,3))) ) ) *
    ( NOT( ISNUMBER(SEARCH("（松下）アイコ", INDEX(format,,3))) ) ) *
    ( INDEX(format,,7) <> "否認" ) *
    ( INDEX(format,,3) <> "" )
  )
)

"0C_マーケ"H2：
=ArrayFormula(
iferror(
let(
パートナーサイト,C2:C,
卸先,
 if(regexmatch(パートナーサイト,":"),
 mid( パートナーサイト,find( ":",パートナーサイト) +2, 300),
 パートナーサイト),

if( regexmatch(卸先,"【")*regexmatch(卸先,"（"),
left( 卸先,find( "（",卸先) -1),
if(regexmatch(卸先,"【"),
left( 卸先,find( "【",卸先) -1),
if(regexmatch(卸先,"（"),
left( 卸先,find( "（",卸先) -1),
卸先))))))

"0C_マーケ"I2：
=ArrayFormula(
iferror(
let(広告主,D2:D,

if(isblank(広告主),,
if(regexmatch(広告主,":"),
mid(広告主, find(":",広告主)+2,300),
広告主)))))

"0C_マーケ"J2：
=ArrayFormula(
iferror(

let(
広告,E2:E,
カッコ抜く, mid( 広告, find( "】",広告)+1, 300),

ハウス,
if(regexmatch(カッコ抜く,"【"),
left( カッコ抜く, find( "【",カッコ抜く)-1),
カッコ抜く),

変換後,
if(ハウス="",
mid( 広告, find( "_",広告)+1, find( "【",広告)-find( "_",広告)-1),
ハウス),

substitute(変換後,"_AD用",))))

"0D_BU"A2：
=let(
  format, hstack(
    Anthem_GAS!A:A,
    Anthem_GAS!B:B,
    Anthem_GAS!C:C,
    Anthem_GAS!D:D,
    Anthem_GAS!E:E,
    Anthem_GAS!F:F,
    Anthem_GAS!G:G
  ),
  filter(
    format,
    (
     isnumber(search("/BU", index(format,,3)))
  )
)
)

"0D_BU"H2：
=ArrayFormula(iferror(
let(
広告,E2:E,
if(regexmatch(広告,"競合PB"),"パーフェクトボディプレミアム",
if(regexmatch(広告,"【")=false,mid( 広告,find( "_", 広告)+1,100),

let(
カッコ抜く,
 if(regexmatch(広告,":"),
 mid( 広告, find( ":",広告)+2, 300),
 広告),
アンダーバー,
 left( カッコ抜く, find( "【",カッコ抜く) -1),

if(regexmatch(アンダーバー,"BTB"),"BTB",
mid( アンダーバー, find( "_",アンダーバー)+1, 200))))))))

"0D_BU"I2：
=ArrayFormula(
iferror(
mid(C2:C,find("(",C2:C)+1,find("★",C2:C)-find("(",C2:C)-1)))

"0D_BU"J2：
=ArrayFormula(
iferror(

mid(C2:C,
find(")",C2:C)+1,
find("(",C2:C,find("(",C2:C)+1)
-find(")",C2:C)-1)))

"0E_★"A2：
=let(
  format, hstack(
    Anthem_GAS!A:A,
    Anthem_GAS!B:B,
    Anthem_GAS!C:C,
    Anthem_GAS!D:D,
    Anthem_GAS!E:E,
    Anthem_GAS!F:F,
    Anthem_GAS!G:G
  ),
  excludePattern, TEXTJOIN("|", TRUE, FILTER('IF卸・トータルマーケ'!A:A, 'IF卸・トータルマーケ'!A:A<>"")),
  FILTER(
    format,
    ( NOT( REGEXMATCH( INDEX(format,,3), excludePattern ) ) ) *
    ( NOT( ISNUMBER( SEARCH("ハウス/", INDEX(format,,5) ) ) ) ) *
    ( INDEX(format,,7) <> "否認" ) *
    ( INDEX(format,,3) <> "" ) *
    (  ISNUMBER( SEARCH("★", INDEX(format,,3) ) ) )
  )
)

"0E_★"H2：
=ArrayFormula(iferror(
let(
広告,E2:E,
if(regexmatch(広告,"競合PB"),"パーフェクトボディプレミアム",
if(regexmatch(広告,"【")=false,mid( 広告,find( "_", 広告)+1,100),

let(
カッコ抜く,
 if(regexmatch(広告,":"),
 mid( 広告, find( ":",広告)+2, 300),
 広告),
アンダーバー,
 left( カッコ抜く, find( "【",カッコ抜く) -1),

if(regexmatch(アンダーバー,"BTB"),"BTB",
mid( アンダーバー, find( "_",アンダーバー)+1, 200))))))))

"0E_★"I2：=ArrayFormula(
iferror(
mid(C2:C,find("(",C2:C)+1,find("★",C2:C)-find("(",C2:C)-1)))

"0E_★"J2：=ArrayFormula(
iferror(

mid(C2:C,
find(")",C2:C)+1,
find("(",C2:C,find("(",C2:C)+1)
-find(")",C2:C)-1)))

"0F_<>★"A2：
=let(
  format, hstack(
    Anthem_GAS!A:A,
    Anthem_GAS!B:B,
    Anthem_GAS!C:C,
    Anthem_GAS!D:D,
    Anthem_GAS!E:E,
    Anthem_GAS!F:F,
    Anthem_GAS!G:G
  ),
  excludePattern, TEXTJOIN("|", TRUE, FILTER('IF卸・トータルマーケ'!A:A, 'IF卸・トータルマーケ'!A:A<>"")),
  FILTER(
    format,
    ( NOT( REGEXMATCH( INDEX(format,,3), excludePattern ) ) ) *
    ( NOT( ISNUMBER( SEARCH("ハウス/", INDEX(format,,5) ) ) ) ) *
    ( INDEX(format,,7) <> "否認" ) *
    ( INDEX(format,,3) <> "" ) *
    ( NOT( ISNUMBER( SEARCH("★", INDEX(format,,3) ) ) ) )
  )
)

"0F_<>★"H2：
=ArrayFormula(iferror(
let(
広告,E2:E,
if(regexmatch(広告,"競合PB"),"パーフェクトボディプレミアム",
if(regexmatch(広告,"【")=false,mid( 広告,find( "_", 広告)+1,100),

let(
カッコ抜く,
 if(regexmatch(広告,":"),
 mid( 広告, find( ":",広告)+2, 300),
 広告),
アンダーバー,
 left( カッコ抜く, find( "【",カッコ抜く) -1),

if(regexmatch(アンダーバー,"BTB"),"BTB",
mid( アンダーバー, find( "_",アンダーバー)+1, 200))))))))

"0F_<>★"I2：=ArrayFormula(
iferror(
mid(C2:C,find("(",C2:C)+1,find(")",C2:C)-find("(",C2:C)-1)))

"0F_<>★"J2：=ArrayFormula(
iferror(

mid(C2:C,
find(")",C2:C)+1,
find("(",C2:C,find("(",C2:C)+1)
-find(")",C2:C)-1)))

"1A_IF"B4：=ArrayFormula(
if(isblank('0A_フィルター'!B2:B),,
datevalue(('0A_フィルター'!A2:A))))

"1A_IF"C4：=ArrayFormula(iferror(


let(
adName,
 '0A_フィルター'!E2:E,

adNameExtract,
 if(
  regexmatch(adName," :"),
  mid(
   adName,
   find( ":",adName)+2,
   300),
  adName),

productNameExtract,
 left(
  adNameExtract,
  find( "【",adNameExtract) -1),


if(
 regexmatch(adName,"競合PB"),
 "パーフェクトボディプレミアム",
if(
 regexmatch(adName,"【")=false,
 mid(adName,find( "_", adName)+1,100),
if(
 regexmatch(productNameExtract,"BTB"),
 "BTB",

mid(
 productNameExtract,
 find( "_",productNameExtract)+1,
 200)))))))

"1A_IF"D4：=ArrayFormula(
if(isblank(I4:I),,
if(isblank(L4:L),K4:K,L4:L)))

"1A_IF"E4：=ArrayFormula(
iferror(


let(
partnerSiteWithStar,

let(
partnerSite,
 '0A_フィルター'!C2:C,

agent,
 if(
  regexmatch(partnerSite," :"),
  mid(
   partnerSite,
   find( ":",partnerSite) +3,
   300),
  mid(
   partnerSite,
   2,
   300)),

left(
 agent,
 find(")",agent)-1)),


if(
 regexmatch(partnerSiteWithStar,"★"),
 left(
  partnerSiteWithStar,
  find("★",partnerSiteWithStar)-1),
  partnerSiteWithStar))))

"1A_IF"F4：=ArrayFormula(J4:J)

"1A_IF"G4：=ArrayFormula(

let(
client,
 '0A_フィルター'!D2:D,

if(
 isblank(client),,
if(
 regexmatch(client,":"),
 mid(client,find(":",client)+2,300),
 client))))

"1A_IF"I4：=ArrayFormula('0A_フィルター'!C2:C)
"1A_IF"J4：=ArrayFormula(
iferror(

let(
partnerSite,I4:I,

mid(
 partnerSite,
 find(")",partnerSite)+1,
 find("(",partnerSite,find("(",partnerSite)+1)
  -find(")",partnerSite)-1))))

"1A_IF"K4：=ArrayFormula(
if(isblank(I4:I),,
value('0A_フィルター'!F2:F)))

"1A_IF"L4：=ArrayFormula(

if(
 isblank(M4:M),,
if(
 countif('Anthem単価変更'!B:B,M4:M)<=1,
 xlookup(
  M4:M,
  'Anthem単価変更'!B:B,
  'Anthem単価変更'!C:C,,),
 xlookup(
  M4:M&datevalue(B4:B),
  'Anthem単価変更'!B:B&'Anthem単価変更'!D:D,
  'Anthem単価変更'!C:C,,-1))))

"1A_IF"M4：=ArrayFormula(
iferror(

let(
adName,
 '0A_フィルター'!E2:E,

adNameAfterColon,
 iferror(
  mid(
   adName,
   find(":",adName)+2,
   300),
  adName),

productName,
 left(
  adNameAfterColon,
  find("【",adNameAfterColon)-1),


if(
 regexmatch(adName,"競合PB"),
 "パーフェクトボディプレミアム",
if(
 regexmatch(adName,"【")=false,
 mid(
  adName,
  find("_", adName)+1,
  100),


if(
 regexmatch(productName,"BTB"),
 "BTB",
if(
 (regexmatch(adNameAfterColon,"Yunth生ビタミンC美容液")*
　regexmatch(adNameAfterColon,"YouTuber")),
 "Yunth生ビタミンC美容液(YouTube)",
if(
 (regexmatch(adNameAfterColon,"Yunth生ビタミンC美容液")*
  regexmatch(adNameAfterColon,"youtube")),
 "Yunth生ビタミンC美容液(YouTube)",

mid(
 productName,
 find("_",productName)+1,
 200))))))),

C4:C))

"1B_IF卸"B4：=ArrayFormula( 
if(isblank('0B_IF卸'!B2:B),,
datevalue('0B_IF卸'!A2:A)))

"1B_IF卸"C4：=ArrayFormula( 
if(isblank('0B_IF卸'!B2:B),,
'0B_IF卸'!J2:J))

"1B_IF卸"D4：=ArrayFormula(
if(
 isblank(C4:C),,
if(
 countif(
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G,
  E4:E&C4:C&I4:I
 )<=1,
 xlookup(
  E4:E&C4:C&I4:I,
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G,
  '卸単価一覧'!H:H,,),
 xlookup(
 E4:E&C4:C&I4:I&datevalue(B4:B),
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G&'卸単価一覧'!A:A,
  '卸単価一覧'!H:H,,-1))))

"1B_IF卸"E4：=ArrayFormula(
iferror(

let(
partnerSite,
'0B_IF卸'!C2:C,

partnerSiteAfterColon,
if(
 regexmatch(partnerSite,":"),
 mid(
  partnerSite,
  find(":",partnerSite)+2,
  300),
 mid(
  partnerSite,
  1,
  300)),


if(
 isblank('0B_IF卸'!B2:B),,

if(
 regexmatch(partnerSiteAfterColon,"【"),
 left(
  partnerSiteAfterColon,
  find("【",partnerSiteAfterColon)-1),

if(
 regexmatch(partnerSiteAfterColon,"\("),
 left(
  partnerSiteAfterColon,
  find("(",partnerSiteAfterColon)-1),

if(
 regexmatch(partnerSiteAfterColon,"_"),
 left(
  partnerSiteAfterColon,
  find("_",partnerSiteAfterColon)-1),

partnerSiteAfterColon)))))))

"1B_IF卸"F4：=ArrayFormula(if(isblank(E4:E),,"ハウス"))

"1B_IF卸"G4：=ArrayFormula(

let(client,
'0B_IF卸'!D2:D,

if(
 isblank('0B_IF卸'!B2:B),,

if(
 isblank(client),,
if(
 regexmatch(client,":"),
 mid(
  client,
  find(":",client)+2,300),
  client)))))

"1B_IF卸"H4：=ArrayFormula(
if(
 isblank(C4:C),,
if(
 countif(
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G,
  E4:E&C4:C&I4:I
 )<=1,
 xlookup(
  E4:E&C4:C&I4:I,
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G,
  '卸単価一覧'!J:J,,),
 xlookup(
 E4:E&C4:C&I4:I&datevalue(B4:B),
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G&'卸単価一覧'!A:A,
  '卸単価一覧'!J:J,,-1))))

"1B_IF卸"I4：
=ArrayFormula(
iferror(

let(
adName,
'0B_IF卸'!E2:E,

formatAdName,
mid(
 adName,
 find("】",adName)
 +1, 1000),


if(
 isblank('0B_IF卸'!B2:B),,

if(
 regexmatch(formatAdName,"Yunth生ビタミンC美容液"),
 if(
  regexmatch(formatAdName,"専用"),
  "特単",
 if(
  regexmatch(formatAdName,"/S】"),
  "特単",
  "通常")),
"通常")))))

"1B_IF卸"J4：=ArrayFormula(if(isblank(C4:C),,"ハウス"))

"1B_IF卸"K4：=ArrayFormula( 
if(isblank('0B_IF卸'!B2:B),,
'0B_IF卸'!E2:E))

"1B_IF卸"M4：=ArrayFormula(D4:D=L4:L)

"1C_マーケ"B4：=ArrayFormula( 
if(isblank('0C_マーケ'!B2:B),,
datevalue('0C_マーケ'!A2:A)))

"1C_マーケ"C4：=ArrayFormula( 
if(isblank('0C_マーケ'!B2:B),,
'0C_マーケ'!J2:J))

"1C_マーケ"D4：=ArrayFormula(

let(
mediaRaw,
E4:E,

media,
if(
 (mediaRaw="ロンバード")
 *(regexmatch(L4:L,"比較リス")),
 "ロンバード(比較リス)",
if(
 (mediaRaw="ロンバード")
 *(regexmatch(L4:L,"SEO")),
 "ロンバード(SEO)",
if(
 (mediaRaw="ロンバード")
 *(regexmatch(L4:L,"PPC")),
 "ロンバード(PPC)",
if(
 (mediaRaw="ロンバード")
 *(regexmatch(L4:L,"【IM")),
 "ロンバード(IM)",
 mediaRaw)))),


if(
 isblank(C4:C),,
if(
 countif(
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G,
  media&C4:C&I4:I
 )<=1,
 xlookup(
  media&C4:C&I4:I,
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G,
  '卸単価一覧'!H:H,,),
 xlookup(
  media&C4:C&I4:I&datevalue(B4:B),
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G&'卸単価一覧'!A:A,
  '卸単価一覧'!H:H,,-1)))))

"1C_マーケ"E4：=ArrayFormula(
iferror(

let(
partnerSite,
'0C_マーケ'!C2:C,

partnerSiteAfterColon,
if(
 regexmatch(partnerSite,":"),
 mid(
  partnerSite,
  find(":",partnerSite)+2,
  300),
 mid(
  partnerSite,
  1,
  300)),


if(
 isblank('0C_マーケ'!B2:B),,

if(
 regexmatch(partnerSiteAfterColon,"（"),
 left(
  partnerSiteAfterColon,
  find("（",partnerSiteAfterColon)-1),

if(
 regexmatch(partnerSiteAfterColon,"_"),
 left(
  partnerSiteAfterColon,
  find("_",partnerSiteAfterColon)-1),

if(
 regexmatch(partnerSiteAfterColon,"【"),
 left(
  partnerSiteAfterColon,
  find("【",partnerSiteAfterColon)-1),

if(
 regexmatch(partnerSiteAfterColon,"\("),
 left(
  partnerSiteAfterColon,
  find("(",partnerSiteAfterColon)-1),

partnerSiteAfterColon))))))))

"1C_マーケ"F4：=ArrayFormula(if(isblank(E4:E),,"トータルマーケ"))

"1C_マーケ"G4：=ArrayFormula(

let(
client,
'0C_マーケ'!D2:D,

formatClient,
if(
 isblank(client),,
if(
 regexmatch(client,":"),
 mid(
  client,
  find(":",client)+2,300),
  client)),


if(
 regexmatch(formatClient,"\("),
 left(
  formatClient,
  find("(",formatClient)-1),
 formatClient)))

"1C_マーケ"H4：=ArrayFormula(

let(
mediaRaw,
E4:E,

media,
if(
 (mediaRaw="ロンバード")
 *(regexmatch(L4:L,"比較リス")),
 "ロンバード(比較リス)",
if(
 (mediaRaw="ロンバード")
 *(regexmatch(L4:L,"SEO")),
 "ロンバード(SEO)",
if(
 (mediaRaw="ロンバード")
 *(regexmatch(L4:L,"PPC")),
 "ロンバード(PPC)",
if(
 (mediaRaw="ロンバード")
 *(regexmatch(L4:L,"【IM")),
 "ロンバード(IM)",
 mediaRaw)))),


if(
 isblank(C4:C),,
if(
 countif(
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G,
  E4:E&C4:C&I4:I
 )<=1,
 xlookup(
  media&C4:C&I4:I,
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G,
  '卸単価一覧'!J:J,,),
 xlookup(
  media&C4:C&I4:I&datevalue(B4:B),
  '卸単価一覧'!D:D&'卸単価一覧'!E:E&'卸単価一覧'!G:G&'卸単価一覧'!A:A,
  '卸単価一覧'!J:J,,-1)))))

"1C_マーケ"I4：=ArrayFormula(
iferror(

let(
adName,
'0C_マーケ'!E2:E,

formatAdName,
mid(
 adName,
 find("】",adName)+1,
 1000),

if(
 isblank('0C_マーケ'!B2:B),,
if(
 regexmatch(formatAdName,"専用"),
 "特単",
if(
 regexmatch(formatAdName,"/S】"),
 "特単",
 "通常"))))))

"1C_マーケ"J4：=ArrayFormula(if(isblank(C4:C),,"トータルマーケ"))

"1C_マーケ"K4：=ArrayFormula( 
if(isblank('0C_マーケ'!B2:B),,
'0C_マーケ'!E2:E))

"1C_マーケ"L4：=ArrayFormula('0C_マーケ'!C2:C)

"1C_マーケ"M4：=sort(unique(L4:L))

"1D_BU"B4：=ArrayFormula(
if(isblank('0D_BU'!B2:B),,
datevalue('0D_BU'!A2:A)))

"1D_BU"C4：=ArrayFormula(iferror(

let(
引用,'0D_BU'!E2:E,
メディア名抽出, 
if(regexmatch(引用,":"),
mid( 引用, find( ":",引用)+2, 300),引用),
案件名抽出, left( メディア名抽出, find( "【",メディア名抽出) -1),

if(regexmatch(引用,"競合PB"),"パーフェクトボディプレミアム",
if(regexmatch(引用,"【")=false,mid( 引用,find( "_", 引用)+1,100),
if(regexmatch(案件名抽出,"BTB"),"BTB",
mid( 案件名抽出, find( "_",案件名抽出)+1, 200)))))))

"1D_BU"E4：=ArrayFormula(
iferror(
let( 星つき担当,

let(
引用,
'0D_BU'!C2:C,
担当,
if(regexmatch(引用,":"),
mid( 引用,find( ":",引用) +3, 300),
mid( 引用,2, 300)),
left( 担当, find( ")",担当) -1)),

if( regexmatch( 星つき担当,"★"), left( 星つき担当, find( "★",星つき担当) -1), 星つき担当))))

"1D_BU"F4：=ArrayFormula(J4:J)

"1D_BU"G4：=ArrayFormula(

let(広告主,
'0D_BU'!D2:D,

if(isblank(広告主),,
if(regexmatch(広告主,":"),
mid(広告主, find(":",広告主)+2,300),広告主))))

"1D_BU"I4：=ArrayFormula('0D_BU'!C2:C)
"1D_BU"J4：=ArrayFormula(
iferror(

mid(I4:I,
find(")",I4:I)+1,
find("(",I4:I,find("(",I4:I)+1)
-find(")",I4:I)-1)))

"1E_★"B4：=ArrayFormula( text( left( '0E_★'!A2:A,　10),"yyyy-mm-dd" ))
C4：=ArrayFormula(iferror('0E_★'!H2:H))
D4：=ArrayFormula(
if(isblank(I4:I),,
if(isblank(L4:L),K4:K,L4:L)))

"1E_★"E4：=ArrayFormula('0E_★'!I2:I)
"1E_★"F4：=ArrayFormula('0E_★'!J2:J)
"1E_★"G4：=ArrayFormula('0E_★'!C2:C)
"1E_★"I4：=ArrayFormula('0E_★'!C2:C)
"1E_★"J4：=ArrayFormula(
iferror(

let(
partnerSite,I4:I,

mid(
 partnerSite,
 find(")",partnerSite)+1,
 find("(",partnerSite,find("(",partnerSite)+1)
  -find(")",partnerSite)-1))))

"1E_★"K4：=ArrayFormula(
if(isblank(I4:I),,
value('0E_★'!F2:F)))

"1E_★"L4：=ArrayFormula(

if(
 isblank(M4:M),,
if(
 countif('Anthem単価変更'!B:B,M4:M)<=1,
 xlookup(
  M4:M,
  'Anthem単価変更'!B:B,
  'Anthem単価変更'!C:C,,),
 xlookup(
  M4:M&datevalue(B4:B),
  'Anthem単価変更'!B:B&'Anthem単価変更'!D:D,
  'Anthem単価変更'!C:C,,-1))))

"1E_★"M4：=ArrayFormula(
iferror(

let(
adName,
 '0E_★'!E2:E,

adNameAfterColon,
 iferror(
  mid(
   adName,
   find(":",adName)+2,
   300),
  adName),

productName,
 left(
  adNameAfterColon,
  find("【",adNameAfterColon)-1),


if(
 regexmatch(adName,"競合PB"),
 "パーフェクトボディプレミアム",
if(
 regexmatch(adName,"【")=false,
 mid(
  adName,
  find("_", adName)+1,
  100),


if(
 regexmatch(productName,"BTB"),
 "BTB",
if(
 (regexmatch(adNameAfterColon,"Yunth生ビタミンC美容液")*
　regexmatch(adNameAfterColon,"YouTuber")),
 "Yunth生ビタミンC美容液(YouTube)",
if(
 (regexmatch(adNameAfterColon,"Yunth生ビタミンC美容液")*
  regexmatch(adNameAfterColon,"youtube")),
 "Yunth生ビタミンC美容液(YouTube)",

mid(
 productName,
 find("_",productName)+1,
 200))))))),

C4:C))

"1F_<>★"B4：=ArrayFormula( text( left( '0F_<>★'!A2:A,　10),"yyyy-mm-dd" ))

"1F_<>★"C4：=ArrayFormula(iferror('0F_<>★'!H2:H))

"1F_<>★"D4：=ArrayFormula(
if(isblank(I4:I),,
if(isblank(L4:L),K4:K,L4:L)))

"1F_<>★"E4：=ArrayFormula('0F_<>★'!I2:I)

"1F_<>★"F4：=ArrayFormula('0F_<>★'!J2:J)

"1F_<>★"G4：=ArrayFormula('0F_<>★'!C2:C)

"1F_<>★"I4：=ArrayFormula('0F_<>★'!C2:C)

"1F_<>★"J4：=ArrayFormula(
iferror(

let(
partnerSite,I4:I,

mid(
 partnerSite,
 find(")",partnerSite)+1,
 find("(",partnerSite,find("(",partnerSite)+1)
  -find(")",partnerSite)-1))))

"1F_<>★"K4：=ArrayFormula(
if(isblank(I4:I),,
value('0F_<>★'!F2:F)))

"1F_<>★"L4：=ArrayFormula(

if(
 isblank(M4:M),,
if(
 countif('Anthem単価変更'!B:B,M4:M)<=1,
 xlookup(
  M4:M,
  'Anthem単価変更'!B:B,
  'Anthem単価変更'!C:C,,),
 xlookup(
  M4:M&datevalue(B4:B),
  'Anthem単価変更'!B:B&'Anthem単価変更'!D:D,
  'Anthem単価変更'!C:C,,-1))))

"1F_<>★"M4：=ArrayFormula(
iferror(

let(
adName,
 '0F_<>★'!E2:E,

adNameAfterColon,
 iferror(
  mid(
   adName,
   find(":",adName)+2,
   300),
  adName),

productName,
 left(
  adNameAfterColon,
  find("【",adNameAfterColon)-1),


if(
 regexmatch(adName,"競合PB"),
 "パーフェクトボディプレミアム",
if(
 regexmatch(adName,"【")=false,
 mid(
  adName,
  find("_", adName)+1,
  100),


if(
 regexmatch(productName,"BTB"),
 "BTB",
if(
 (regexmatch(adNameAfterColon,"Yunth生ビタミンC美容液")*
　regexmatch(adNameAfterColon,"YouTuber")),
 "Yunth生ビタミンC美容液(YouTube)",
if(
 (regexmatch(adNameAfterColon,"Yunth生ビタミンC美容液")*
  regexmatch(adNameAfterColon,"youtube")),
 "Yunth生ビタミンC美容液(YouTube)",

mid(
 productName,
 find("_",productName)+1,
 200))))))),

C4:C))

"2A_成形1"B4：

=iferror( LET( data_range, VSTACK( '1A_IF'!B4:G, '1B_IF卸'!B4:J, '1C_マーケ'!B4:J ), filtered_data, FILTER( data_range, (INDEX(data_range, , 1) <> "") * NOT(ISNUMBER(SEARCH("営業", INDEX(data_range, , 4)))) * NOT(ISNUMBER(SEARCH("三田", INDEX(data_range, , 4)))) * NOT(ISNUMBER(SEARCH("鈴木さ", INDEX(data_range, , 4)))) * NOT(ISNUMBER(SEARCH("DM_", INDEX(data_range, , 4)))) * NOT(ISNUMBER(SEARCH("アパレル_", INDEX(data_range, , 4)))) ), SORT(filtered_data, 1, FALSE) ) )

  

"2A_成形1"L4：=query({'1E_★'!B4:F}, "where Col1 is not null and not Col4 contains '営業' and Col1 < " & text(today(),"'yyyy-mm-dd'")&" order by Col1 desc")

  

"2A_成形1"R4：=query({'1F_<>★'!B4:F}, "where Col1 is not null and not Col4 contains '営業' and Col1 < " & text(today(),"'yyyy-mm-dd'")&" order by Col1 desc")

  

"2A_成形1"X4：=ArrayFormula('1D_BU'!B4:F)
```

