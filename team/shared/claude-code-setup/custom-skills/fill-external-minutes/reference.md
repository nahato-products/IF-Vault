# fill-external-minutes Reference

## 依存ツール・環境変数

| ツール | 用途 | 認証 |
|--------|------|------|
| Notion MCP | 内部議事録取得・外部議事録作成 | MCP接続 |
| `gog gmail` | メールスレッド検索 | gog認証 required |
| `gog calendar` | MTG予定取得 | gog認証 required |
| `gog drive` | 関連資料検索 | gog認証 required |

## コマンドリファレンス

### Notion MCP

```
notion_search(query: "プロジェクトAlpha 議事録")
→ page_id 取得

notion_get_page_content(page_id: "<page_id>")
→ Markdown形式で内容取得
```

### gog gmail

```bash
# MTG関連メール検索
gog gmail search "subject:プロジェクトAlpha newer_than:14d" --max 10 --json

# 特定相手とのやりとり
gog gmail search "from:client@example.com OR to:client@example.com subject:Alpha" --json
```

### gog calendar

```bash
# 直近のMTG検索
gog calendar search "プロジェクトAlpha" --json

# イベント詳細
gog calendar event <calendarId> <eventId> --json
```

### gog drive

```bash
# 関連資料検索
gog drive search "プロジェクトAlpha" --json

# 資料のURL取得
gog drive url <fileId>
```

## パターン辞書

### 機密フィルタリング辞書（3段階）

#### Level 1: 自動除去マーカー

該当行は無条件で除去する。

```regex
\(内部\)
※社内用
MEMO:
\(社内\)
※内部用
```

#### Level 2: キーワード除去

該当キーワードを含む文を除去する。

```regex
# コスト関連
(開発コスト|人件費|見積.?金額|予算|原価|利益率|マージン)

# 内部評価
(イマイチ|微妙|ダメ|交渉余地|落としどころ|妥協|本音)

# 社内プロセス
(上長|承認待ち|部署間|社内調整|根回し|稟議)

# 未確定
(検討中|仮で|たぶん|おそらく|未定|TBD|要相談)
```

#### Level 3: 要確認トリガー

Level 1・2 に非該当だが内部的な主語を含む場合、`[要確認]` を付与。

```regex
(うちの|うちが|チームで|社内で|部署|内部的に)
```

### 文体変換ルール（上から順に適用）

| # | ルール | 内部表現 | 外部表現 |
|---|--------|---------|---------|
| 1 | 主語変換 | 「うちが」「チームで」 | 「弊社にて」 |
| 2 | 相手敬称 | 「クライアント」「先方」 | 「○○様」 |
| 3 | 期限具体化 | 「来週中」「月末まで」 | 具体日付（例: 1/24(金)まで） |
| 4 | 曖昧→丁寧 | 「たぶんできる」 | 「実現可否を調査いたします」 |
| 5 | 否定→婉曲 | 「無理です」 | 「技術的制約により難しい状況です」 |
| 6 | 依頼→敬語 | 「○○してほしい」 | 「○○をお願いできますでしょうか」 |

### 安全マーカー（残してOK）

```
決定事項、確定、合意、承認済み、対応完了、スケジュール確定
```

### 出力検証チェックリスト

外部共有前に確認:

- [ ] 社内コスト・予算情報が含まれていないか
- [ ] 内部評価・感想が含まれていないか
- [ ] 未確定情報が確定事項として書かれていないか
- [ ] 敬語・敬称が適切か
- [ ] 期限が具体的な日付になっているか
- [ ] 担当者名が適切か（社内→名前、社外→○○様）
- [ ] [要確認] マークが残っていないか

## トラブルシューティング

| エラー | 原因 | 対処 |
|--------|------|------|
| Notion検索で内部議事録が見つからない | ページタイトル不一致 | `notion_search` でキーワード変えて再検索 |
| gog認証エラー | OAuthトークン失効 | `gog auth login` で再認証 |
| フィルタリングで情報が消えすぎる | Level 2 キーワードが広すぎる | Level 3（[要確認]）に降格して手動判断 |
| 外部向け文体が不自然 | 変換ルール適用漏れ | 変換ルールを上から順に再適用 |
| カレンダー情報が取得できない | calendarId 不一致 | `gog calendar list` で正しいIDを確認 |
