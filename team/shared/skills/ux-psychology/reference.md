# UX for App Development — Reference

SKILL.md の補足資料。実装ガイド、コンポーネント別パターン、アンチパターン、チェックリスト、参考文献。

---

## フォーム設計

- ラベルはフィールドの上（左配置より完了率が高い）
- プレースホルダーをラベル代わりにしない（入力後に消える）
- 必須マークは`*`よりも任意項目に「任意」と表記する方が良い
- バリデーションはリアルタイム（送信後の一括表示は避ける）→ H5
- エラーメッセージは該当フィールドの直下に赤+アイコンで表示
- 成功状態も視覚フィードバック（緑のチェックマーク）
- 入力タイプを正しく設定（`type="email"`, `type="tel"`, `inputmode="numeric"`）
- オートフィル対応: `autocomplete`属性を正しく設定
- 長いフォームはステップ分割、進捗表示付き → #19
- 入力の寛容性 → #13 ポステルの法則

---

## レスポンシブとモバイル

- タップターゲット: 44x44px以上、間隔8px以上 → #22
- 親指ゾーン: 主要操作は画面下部に配置（片手操作）
- ハンバーガーメニューは最終手段: 主要ナビは常に表示
- 横スクロールは避ける（テーブルは横スクロール可だが下記参照）
- フォントサイズ: 本文16px以上（ピンチズーム不要に）
- タッチフィードバック: タップ時に視覚的反応（`:active`状態）
- ボトムタブバー: 3〜5項目まで。左端と右端に最重要機能 → #6
- ジェスチャー: スワイプで戻る、プルダウンリフレッシュは慣習に従う。独自ジェスチャーは避ける

---

## 色とタイポグラフィ

### 色の実装ルール

| 用途 | 色 | 備考 |
|---|---|---|
| 成功・完了 | 緑系 | |
| エラー・破壊的操作 | 赤系 | 色だけに頼らずアイコン併用 |
| 警告 | オレンジ/黄系 | |
| 情報・リンク | 青系 | |
| 無効・非活性 | グレー系 | |

- 色数は3色以内（ブランドカラー、アクセント、ニュートラル）
- 文化差: グローバル展開時は装飾色を文化圏ごとに検証

### タイポグラフィ

- フォントファミリーは2種類まで（見出し用＋本文用）
- 行間: 本文は1.5〜1.75、見出しは1.2〜1.3
- 行の長さ: 60〜80文字（日本語は25〜40文字）
- フォントサイズのスケール: 1.25倍比（16, 20, 25, 31...）
- ウェイト: Regular(400), Medium(500), Bold(700) の3段階で十分

---

## データテーブルとリスト

### 基本構造
- セマンティックHTML: `<table>`, `<thead>`, `<th scope="col">`, `<tbody>` を正しく使う
- 固定ヘッダー: スクロール時に列ヘッダーを `position: sticky` で固定
- 固定列: IDや名前列を左固定してコンテキストを維持

### ページネーション vs 仮想スクロール
- 100行以下: ページネーション不要、全件表示
- 100〜1000行: ページネーション（10/25/50/100行の切り替え付き）
- 1000行超: 仮想スクロール（`react-virtual`等）でDOM負荷を軽減
- 無限スクロールはフッター到達不能のリスク。使う場合はスティッキーフッター併用

### ソート・フィルター
- ソートインジケーター（▲▼）を列ヘッダーに表示。`aria-sort`属性を設定
- フィルターは列ヘッダー直下またはツールバーに配置
- アクティブなフィルター条件を常に可視化（チップ表示 + 「クリア」ボタン）

### インライン編集
- セルクリック → 編集モード → フォーカスアウトで保存、ESCでキャンセル
- 編集中セルは視覚的に区別（ボーダー色変更等）
- 保存中/エラー/変更未保存の状態を各セルに表示

### バルクアクション
- ヘッダーチェックボックスで全選択/全解除
- 選択中の件数をツールバーに表示（「3件選択中」）
- 一括操作ボタン（削除、エクスポート等）は選択時のみ表示

### レスポンシブ対応
- モバイルではカード表示に切り替えるか、優先列のみ表示+「詳細」リンク
- 横スクロール使用時は影やフェードで「続きがある」ことを示す

---

## AIチャットUI

### ストリーミング応答
- タイピングインジケーター（「...」アニメ）はAIが応答開始するまで表示
- ストリーミング中は自動スクロール。ユーザーが上にスクロールしたら自動スクロールを停止
- 「停止」ボタンをストリーミング中に表示。押したら生成を中断
- コードブロック・マークダウンはストリーミング中もプログレッシブにレンダリング

### メッセージUI
- ユーザー側とAI側でバブルの色・配置を明確に区別
- AI出力に「AIが生成」ラベル → #28 透明性
- コードブロックにコピーボタン、シンタックスハイライト
- 長い出力は折りたたみ（「もっと見る」）で初期表示量を制御

### 入力UX
- テキストエリアは内容に応じて自動リサイズ（最大高さ制限付き）
- Enter で送信、Shift+Enter で改行（逆も設定可能に）
- 添付ファイル/画像のプレビュー表示
- プロンプトテンプレート/サジェストで初回利用を支援 → #18

### エラーハンドリング
- ネットワーク切断時: メッセージ再送ボタン
- レート制限時: 「しばらく待ってから再試行」+ カウントダウン
- AI生成エラー時: 「再生成」ボタン + 手動入力へのフォールバック → #29

### 会話管理
- 会話の命名（自動+手動編集）、検索、ピン留め、削除
- 新しい会話の開始を常にアクセス可能に

---

## ダッシュボード・データビジュアライゼーション

### チャートタイプの選択基準
| データの性質 | 推奨チャート |
|---|---|
| 時系列推移 | 折れ線グラフ |
| カテゴリ比較 | 棒グラフ（横棒: カテゴリ名が長い場合） |
| 構成比 | 円/ドーナツグラフ（5カテゴリ以下） |
| 相関関係 | 散布図 |
| 分布 | ヒストグラム |

- 3Dグラフ、過度なグリッド線、装飾は避ける（データインク比を高く保つ）
- チャートの色は色覚多様性を考慮（パターンや形状で補完）

### KPIカード
- 数値は大きなフォントで目立たせる
- 前期比を矢印（↑↓）+ 色（緑/赤）で表示。色だけに頼らない
- スパークライン（小さな推移グラフ）で直近トレンドを示す
- 目標対比がある場合はプログレスバーで表現

### リアルタイム更新
- 自動更新時のちらつき防止: 値の変更箇所だけアニメーション
- 「最終更新: 2分前」の表示 + 手動更新ボタン
- WebSocket接続状態を表示（接続中/切断/再接続中）

### 日付範囲セレクター
- プリセット: 今日/今週/今月/先月/カスタム
- カスタム範囲はカレンダーピッカーで選択
- 比較期間の設定（前年同期比等）

### 空状態
- データ0件のチャートは「まだデータがありません」+ データ取得方法の案内
- 初期状態とエラー状態を視覚的に区別

---

## アンチパターン集

レビュー時に以下を見つけたら即修正。

### ダークパターン（倫理的にNG）
- **ローチモーテル**: 登録は簡単なのに退会が極端に困難
- **こっそりカゴ入れ**: ユーザーが選んでいないものをカートに追加
- **羞恥確認**: 「いいえ、お金を節約したくありません」のような罪悪感を煽る選択肢
- **強制開示**: サービスに不要な個人情報の入力を強制
- **視覚的ミスディレクション**: 解約ボタンをグレーアウトや極小フォントで隠す

### AIアンチパターン
- **ハルシネーション隠蔽**: AIの誤出力を検証なしにそのまま表示 → #28 透明性で対策
- **AI強制**: 手動操作の選択肢がなくAI利用を強制 → #29 制御で対策
- **ブラックボックス**: なぜその結果になったか説明なし → ユーザーの信頼を失う

### 実装アンチパターン
- **ミステリーナビ**: アイコンだけでラベルなし → H6
- **無限スクロールの罠**: フッター情報にたどり着けない → ページネーションかスティッキーフッター
- **モーダル地獄**: モーダルの上にモーダル → 同時に1つまで
- **自動再生**: 音声付き動画の自動再生 → #11
- **ズーム無効化**: `user-scalable=no` → アクセシビリティ違反
- **プレースホルダー依存**: ラベル代わりのプレースホルダー → 入力開始で消えて迷う
- **赤一色のエラー**: 色だけでエラー伝達 → 色覚多様性に対応できない
- **確認ダイアログ乱発**: 全操作に「よろしいですか？」→ 不可逆操作だけに絞る
- **disabled送信ボタン**: なぜ押せないか理由が不明 → バリデーションエラーをインラインで明示
- **水平スクロール**: モバイルで横にはみ出るレイアウト

---

## 実装チェックリスト

### 情報設計
- [ ] 1画面の選択肢は5個以内か
- [ ] 段階的開示を使えるか
- [ ] 視覚的階層は明確か

### フィードバック
- [ ] 応答は400ms以内か（超える場合はスケルトンUI）
- [ ] エラーメッセージは具体的で回復可能か
- [ ] Undo/やり直しが可能か
- [ ] 状態遷移（ローディング→成功/エラー→空状態）は全て設計されているか

### フォーム
- [ ] ラベルはフィールドの上か
- [ ] バリデーションはリアルタイムか
- [ ] 入力の寛容性（全角半角、ハイフン有無）は確保されているか
- [ ] デフォルト値はユーザーに最適か

### モバイル
- [ ] タップターゲットは44x44px以上か
- [ ] 親指ゾーンに主要操作があるか
- [ ] フォントサイズは16px以上か

### アクセシビリティ
- [ ] キーボードだけで全操作できるか
- [ ] スクリーンリーダーで意味が伝わるか
- [ ] `prefers-reduced-motion`に対応しているか
- [ ] エラーは色+アイコン+テキストで伝えているか
- [ ] ニューロダイバーシティ: テキスト左揃え、行間1.5以上、通知最小限か

### AI UX
- [ ] AI出力に「AIが生成」のラベルがあるか
- [ ] AI提案を手動で上書き・却下できるか
- [ ] AI失敗時の手動フォールバックがあるか

### 安全性
- [ ] 破壊的操作に確認ステップがあるか
- [ ] ダークパターンになっていないか

---

## 参考文献

- Miller, G.A. (1956). "The Magical Number Seven, Plus or Minus Two"
- Cowan, N. (2001). "The Magical Number 4 in Short-Term Memory"
- Schwartz, B. (2004). *The Paradox of Choice*
- Nielsen, J. (1994). "10 Usability Heuristics for User Interface Design"
- Norman, D. (2013). *The Design of Everyday Things*
- Krug, S. (2014). *Don't Make Me Think*
- Fitts, P.M. (1954). "The Information Capacity of the Human Motor System"
- Doherty, W.J. & Thadani, A.J. (1982). "The Economic Value of Rapid Response Time"
- Buell, R.W. & Norton, M.I. (2011). "The Labor Illusion"
- W3C (2023). "Web Content Accessibility Guidelines (WCAG) 2.2"
- NN/g (2026). "State of UX 2026: Design Deeper to Differentiate"
- Laws of UX — https://lawsofux.com
