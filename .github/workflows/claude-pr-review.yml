name: Claude PR ãƒ¬ãƒ“ãƒ¥ãƒ¼

on:
  pull_request:
    types: [opened, synchronize]
    # ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ»ãƒãƒ¼ãƒˆå¤‰æ›´ã®ã¿ã‚’å¯¾è±¡ï¼ˆã‚³ãƒ¼ãƒ‰ãƒ¬ãƒ“ãƒ¥ãƒ¼ã¯ä¸è¦ãªPRã‚’é™¤å¤–ï¼‰
    paths-ignore:
      - "**/*.md"
      - "assets/**"
      - "templates/**"

jobs:
  claude-review:
    name: Claude Code Review
    runs-on: ubuntu-latest
    permissions:
      contents: read
      pull-requests: write

    steps:
      - uses: actions/checkout@v4
        with:
          fetch-depth: 0

      - name: Claude Code PR ãƒ¬ãƒ“ãƒ¥ãƒ¼
        uses: anthropics/claude-code-action@v1
        with:
          anthropic_api_key: ${{ secrets.ANTHROPIC_API_KEY }}
          # code-reviewer ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆã«ç›¸å½“ã™ã‚‹ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
          direct_prompt: |
            ã“ã®PRã‚’4ãƒ‘ã‚¹ã§ãƒ¬ãƒ“ãƒ¥ãƒ¼ã—ã¦ãã ã•ã„ã€‚

            ## Pass 1: ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£
            - æ©Ÿå¯†æƒ…å ±ã®ãƒãƒ¼ãƒ‰ã‚³ãƒ¼ãƒ‰ï¼ˆAPIã‚­ãƒ¼ãƒ»ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ï¼‰
            - ãƒ‘ã‚¹ãƒ»ã‚³ãƒãƒ³ãƒ‰ã‚¤ãƒ³ã‚¸ã‚§ã‚¯ã‚·ãƒ§ãƒ³ãƒªã‚¹ã‚¯
            - æ¨©é™ãƒ»èªè¨¼ã®æŠœã‘

            ## Pass 2: å“è³ª
            - å‘½åã®ä¸€è²«æ€§ï¼ˆkebab-case / camelCase ç­‰ï¼‰
            - é‡è¤‡ã‚³ãƒ¼ãƒ‰ãƒ»ãƒã‚¸ãƒƒã‚¯ãƒŠãƒ³ãƒãƒ¼
            - ã‚¨ãƒ©ãƒ¼ãƒãƒ³ãƒ‰ãƒªãƒ³ã‚°ã®æŠœã‘

            ## Pass 3: æ•´åˆæ€§
            - CLAUDE.md ã®è¦ç´„ã«æ²¿ã£ã¦ã„ã‚‹ã‹
            - æ—¢å­˜ã‚³ãƒ¼ãƒ‰ã®ãƒ‘ã‚¿ãƒ¼ãƒ³ã¨ä¸€è‡´ã—ã¦ã„ã‚‹ã‹

            ## Pass 4: æ”¹å–„ææ¡ˆ
            - ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãƒ»ä¿å®ˆæ€§ã®è¦³ç‚¹ã§1ã€œ3ä»¶

            çµæœã¯æ—¥æœ¬èªã§ã€severityï¼ˆğŸ”´ CRITICAL / ğŸŸ¡ WARNING / ğŸŸ¢ SUGGESTIONï¼‰ä»˜ãã§å‡ºåŠ›ã—ã¦ãã ã•ã„ã€‚
          allowed_tools: "Read,Glob,Grep,Bash"
