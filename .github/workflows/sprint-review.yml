name: Sprint Review Notification

on:
  schedule:
    # JST é‡‘æ›œ 17:00 = UTC é‡‘æ›œ 08:00
    - cron: '0 8 * * 5'
  workflow_dispatch: # æ‰‹å‹•å®Ÿè¡Œã‚‚å¯èƒ½

jobs:
  notify-sprint-review:
    runs-on: ubuntu-latest

    steps:
      - name: Notify Slack
        env:
          SLACK_WEBHOOK_URL: ${{ secrets.SLACK_WEBHOOK_URL }}
        run: |
          curl -X POST "$SLACK_WEBHOOK_URL" \
            -H 'Content-Type: application/json' \
            -d '{
              "username": "ã‚¹ãƒ—ãƒªãƒ³ãƒˆBot",
              "icon_emoji": ":chart_with_upwards_trend:",
              "text": "ã‚¹ãƒ—ãƒªãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ã®æ™‚é–“ã§ã™ï¼",
              "blocks": [
                {
                  "type": "header",
                  "text": {
                    "type": "plain_text",
                    "text": "ã‚¹ãƒ—ãƒªãƒ³ãƒˆãƒ¬ãƒ“ãƒ¥ãƒ¼ ğŸ“Š",
                    "emoji": true
                  }
                },
                {
                  "type": "divider"
                },
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "*ã€ä»Šé€±ã®ç›®æ¨™ã€‘*\nã‚¹ãƒ—ãƒªãƒ³ãƒˆé–‹å§‹æ™‚ã«è¨­å®šã—ãŸç›®æ¨™ã‚’æŒ¯ã‚Šè¿”ã‚Šã¾ã—ã‚‡ã†"
                  }
                },
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "*ã€ä»Šé€±ã®æˆæœã€‘*\nå®Œäº†ã—ãŸã‚¿ã‚¹ã‚¯ã‚„å®Ÿè£…ã—ãŸæ©Ÿèƒ½ã‚’å…±æœ‰"
                  }
                },
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "*ã€é”æˆç‡ã€‘*\né”æˆç‡: _%_\nç›®æ¨™ã«å¯¾ã™ã‚‹é€²æ—çŠ¶æ³ã‚’ç¢ºèª"
                  }
                },
                {
                  "type": "section",
                  "text": {
                    "type": "mrkdwn",
                    "text": "*ã€ãƒ™ãƒ­ã‚·ãƒ†ã‚£ã€‘*\nä»Šé€±: _pt_\nå¹³å‡: _pt_\nãƒãƒ¼ãƒ ã®é€Ÿåº¦ã‚’æ¸¬å®š"
                  }
                }
              ]
            }'
